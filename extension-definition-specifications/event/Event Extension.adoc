:stylesheet: stix.css
:stylesdir: ../../asciidoc-shared
:toc: macro
:nofooter:

= [stixtitle]*Event Extension Version 1.0 for STIX^TM^ Version 2.1*

[.stix-doc-information-heading]#Draft#

[.stix-doc-information-heading]#26 March 2023#

[.stix-doc-information-heading]
Editors:
[.stix-indent]
* IMG - Incident Mini Group


[.stix-doc-information-heading]
Additional artifacts:
[.stix-indent]
.This prose specification is one component of a Work Product that also includes:

- STIXâ„¢ Version 2.1 - OS
- Impact Extension Version 1.0 for STIX^TM^ Version 2.1
- Incident Core Extension Version 2.0 for STIX^TM^ Version 2.1
- Task Extension Version 1.0 for STIX^TM^ Version 2.1


[.stix-doc-information-heading]
Related work:

[.stix-indent]
.This specification replaces or supersedes: +

- N/A

toc::[]

[.stix-doc-information-heading]*Abstract:*

The current STIX 2.1 Incident object exists as a stub in the hopes that future work would allow STIX Incidents to be more fully fleshed out using extensions, and that in time a set of core features could be defined to be migrated into a future version of the Incident object or the community could arrive at the consensus to continue to use these extensions.

This extension is focused on recording attacker, defender, and other related activities that occur during an incident and prior to an incident being declared.
This extension also provides both new means and examples of connections to a number of existing STIX Objects in order to facilitate highly interoperable verbose reporting that does not overburden analysts to initially generate or maintain.

== 1. Events in STIX

Events represent things that have ocurred or are expected to occur that could impact an organization.
Events can store a list of sub-events that can be optionally ordered to provide greater fidelity.
Events often take place prior to an incident being declared, and events with impacts or suspected impacts often lead to incidents being created.

<<<

== 2. Event Extension

[width="100%",cols="100%",stripes=odd]
|===
^|[stixtr]*Required Common Properties*
|*created*,
*id*,
*modified*,
*spec_version*,
*type*

^|[stixtr]*Optional Common Properties*

|*created_by_ref*,
*revoked*,
*labels*,
*confidence*,
*lang*,
*external_references*,
*object_marking_refs*,
*granular_markings*,
*extensions*

^|[stixtr]*Not Applicable Common Properties*

|*defanged*

^|[stixtr]*Event Object Specific Properties*

|*description*,
*end_time*,
*end_time_fidelity*,
*goal*,
*name*,
*outcome*,
*pattern_refs*,
*sighting_refs*,
*start_time*,
*start_time_fidelity*,
*subevents*
|===

|===
^|[stixtr]*Property Name* ^|[stixtr]*Type* ^|[stixtr]*Description*

|*outcome* (required)
|[stixtype]#event-outcome-enum#
|The outcome of the event.

|*type* (required)
|[stixtype]#string#
|The value of this property *MUST* be set to [stixliteral]#event#.

|*description* (optional)
|[stixtype]#string#
|A description of event that occurred.

|*end_time* (optional)
|[stixtype]#timestamp#
|The date and time the event was last recorded. If this is not present it is assumed to be unknown.

|*end_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|The level of fidelity that the end_time is recorded in.
This value *MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be accurate up to the number of decimals it includes.

|*goal* (optional)
|[stixtype]#string#
|The assumed objective of this event.
Not all events have goals.

|*name* (optional)
|[stixtype]#string#
|An optional name for the event.

|*pattern_refs* (optional)
|[stixtype]#list# of type [stixtype]#identifier#
|An optional list of attack patterns or attacker playbooks that were demonstrated by the event.

|*sighting_refs* (optional)
|[stixtype]#list# of type [stixtype]#identifier#
|An optional list of sightings that were related to this event.
Sightings referenced in this *SHOULD* be based on Indicator or Malware SDOs.

In some cases observed data may be present, but no Indicator can be created.
In these cases it is appropriate to have the Sighting use the Event itself as its *sighting_of_ref*.

|*start_time* (optional)
|[stixtype]#timestamp#
|The date and time the event was first recorded. If this is not
present it is assumed to be unknown.

This property *SHOULD* be populated.

|*start_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|The level of fidelity that the start_time is recorded in. This value
*MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be
accurate up to the number of decimals it includes.

|*subevents* (optional)
|[stixtype]#list# of type [stixtype]#event-sequence#
|A list of sub-event that this event was composed of.
|===

<<<

=== 2.1 Event-Sequence Object Type

*Type Name:* [stixtype]#event-sequence#

[width="100%",cols="37%,23%,40%",options="header",]
|===
^|[stixtr]*Property Name*
^|[stixtr]*Type* 
^|[stixtr]*Description*

|*event_ref* (required)
|[stixtype]#identifier# 
|This property specifies the event that ocurred at this point in the sequence.

The object referenced *MUST* be of type [stixtype]#event#.

|*sequence_end* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the last point in an event is believed to have occurred relative to other [stixtype]#event-sequence# entries in the same list.

This *MUST NOT* be less than the [stixtype]*sequence_start* value, but the two can be equal.

|*sequence_start* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the earliest point this event is believed to have occurred relative to other [stixtype]#event-sequence# entries in the same list.

This *MUST NOT* exceed the [stixtype]*sequence_end* value, but the two can be equal.
|===

<<<

=== 3.1 Event Outcome Enumeration

*Type Name*: [stixtype]#event-outcome-enum#

[width="100%",cols="28%,72%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#blocked#
|The event was blocked from having its intended effect by pre-emptive measures.

Attacker activities can be blocked by solutions such as rate limiting or spam filters.

|[stixliteral]#ongoing#
|The event is still occurring.

|[stixliteral]#no-effect#
|The event had no effect, but not due to any affirmative defense.

For example: running a VisualBasic script failed because it was on a Linux machine.

|[stixliteral]#occurred#
|The event took and is no longer ongoing.

|[stixliteral]#pending#
|The event has not yet been started or observed, but it is projected or otherwise planned. 

Pending activity may never occur as various factors can cause it to be blocked or not attempted.
As such any time or sequence values for pending activities should be treated as an estimation or projection that is subject to change.

|[stixliteral]#prevented#
|The event was prevented from taking place.

For example: A public threat was announced, but the individuals who would have performed it were arrested prior to taking action.

|[stixliteral]#unknown#
|The outcome of the event is not yet known.
|===

<<<

=== 3.2 Timestamp Fidelity Enumeration

*Type Name*: [stixtype]#timestamp-fidelity-enum#

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#day#
|The associated timestamp should be considered to represent a time within the one day period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for this activity.

|[stixliteral]#hour#
|The associated timestamp should be considered to represent a time within the one hour period starting with the provided timestamp.

|[stixliteral]#minute#
|The associated timestamp should be considered to represent a time within the one minute period starting with the provided timestamp.

|[stixliteral]#month#
|The associated timestamp should be considered to represent a time within the one month period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the activity.
The day should always be listed as the first or the last day of the previous month if in a timezone that is offset before UTC.

|[stixliteral]#second#
|The associated timestamp should be considered to represent a time within the one second period starting with the provided timestamp.

|[stixliteral]#year#
|The associated timestamp should be considered to represent a time within the one year period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the activity.

|===

<<<

== 4.0 Relationships

[width="100%",cols="27%,16%,24%,33%",options="header",]
|===
4+^|[stixtr]*Common Relationships*
4+|[stixrelationship]#derived-from#,
[stixrelationship]#duplicate-of#,
[stixrelationship]#related-to#

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*event* 
|[stixrelationship]#led-to#
|[stixtype]*event* 
|One event led to another.
For example a dropper running allowed a ransomware tool to be downloaded and run.

|[stixtype]*event*
|[stixrelationship]#impacts#
|[stixtype]*infrastructure*, +
<All STIX Cyber-observable Objects>
|The event impacts infrastructure or other resources that are identified by cyber-observable objects.

|[stixtype]*event*
|[stixrelationship]#located-at#
|[stixtype]*location*
|The event occurred at a specific location or locations.

|[stixtype]*event*
|[stixrelationship]#observed#
|<All STIX Cyber-observable Objects>
|STIX cyber-observables were observed as part of this event, but no information on when they are observed is being shared.

If this can be shared a Sighting it should be instead of using this method.
|===

<<<

[width="100%",cols="27%,16%,24%,33%",options="header",]
|===
4+^|[stixtr]*Reverse Relationships*

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*indicator*
|[stixrelationship]#based-on#
|[stixtype]*event*
|An indicator is based on an event.

|[stixtype]*malware*
|[stixrelationship]#performed#
|[stixtype]*event*
|Malware performed a specific event.

|[stixtype]*tool*
|[stixrelationship]#performed#
|[stixtype]*event*
|A tool performed a specific event.
|===

<<<

== Appendix A. Revision History

[width="100%",cols="18%,16%,23%,43%",options="header",]
|===
^|[stixtr]*Revision* ^|[stixtr]*Date* ^|[stixtr]*Editor* ^|[stixtr]*Changes Made*
|01
|<TBD>
|Incident Mini Group
|Initial Version

|===