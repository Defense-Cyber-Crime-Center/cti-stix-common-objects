:stylesheet: stix.css
:stylesdir: ../../asciidoc-shared
:toc: macro
:nofooter:

= [stixtitle]*Incident Activity Extension Version 1.0 for STIX^TM^ Version 2.1*

[.stix-doc-information-heading]#Draft#

[.stix-doc-information-heading]#26 March 2023#

[.stix-doc-information-heading]
Editors:
[.stix-indent]
* IMG - Incident Mini Group


[.stix-doc-information-heading]
Additional artifacts:
[.stix-indent]
.This prose specification is one component of a Work Product that also includes:

- STIXâ„¢ Version 2.1 - OS
- Impact Extension Version 1.0 for STIX^TM^ Version 2.1
- Incident Core Extension Version 2.0 for STIX^TM^ Version 2.1


[.stix-doc-information-heading]
Related work:

[.stix-indent]
.This specification replaces or supersedes: +

- N/A

toc::[]

[.stix-doc-information-heading]*Abstract:*

The current STIX 2.1 Incident object exists as a stub in the hopes that future work would allow STIX Incidents to be more fully fleshed out using extensions, and that in time a set of core features could be defined to be migrated into a future version of the Incident object or the community could arrive at the consensus to continue to use these extensions.

This extension is focused on recording attacker, defender, and other related activities that occur during an incident and prior to an incident being declared.
This extension also provides both new means and examples of connections to a number of existing STIX Objects in order to facilitate highly interoperable verbose reporting that does not overburden analysts to initially generate or maintain.

== 1. Incidents in STIX

Incident objects represent activities that have occurred, are expected to happen, and are ongoing.
All activities have an optional parent that can point to either an activity or incident allowing sub activities to be recorded.
Activities can also be recorded prior to an incident being declared.

Activities have a large number of common relationships that allows for sharing detailed information about the who, what and where the activity.
The what and when of an activity is recorded directly on the activity itself.

<<<

== 2. Incident Activity Extension

[width="100%",cols="100%",stripes=odd]
|===
^|[stixtr]*Required Common Properties*
|*created*,
*id*,
*modified*,
*spec_version*,
*type*

^|[stixtr]*Optional Common Properties*

|*created_by_ref*,
*revoked*,
*labels*,
*confidence*,
*lang*,
*external_references*,
*object_marking_refs*,
*granular_markings*,
*extensions*

^|[stixtr]*Not Applicable Common Properties*

|*defanged*

^|[stixtr]*Incident Activity Object Specific Properties*

|*activity_category*,
*incident_ref*,
*outcome*
|===

|===
^|[stixtr]*Property Name* ^|[stixtr]*Type* ^|[stixtr]*Description*

|*activity_category* (required)
|[stixtype]#activity-category-enum#
|If this activity was performed by the attacker, defender, or simply took place.

|*outcome* (required)
|[stixtype]#activity-outcome-enum#
|The outcome of the activity.

|*type* (required)
|[stixtype]#string#
|The value of this property *MUST* be set to incident-activity.

|*activity_type* (optional)
|[stixtype]#open-vocabulary#
|A high level type for the activity in order to enable rollups and summaries. This should be drawn from activity-type-ov.

|*description* (optional)
|[stixtype]#string#
|A description of activity that occurred.

|*end_time* (optional)
|[stixtype]#timestamp#
|The date and time the activity was last recorded. If this is not present it is assumed to be unknown.

|*end_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|
The level of fidelity that the end_time is recorded in. This value
*MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be
accurate up to the number of decimals it includes.

|*goal* (optional)
|[stixtype]#string#
|The assumed objective of this activity.

|*parent_ref* (optional)
|[stixtype]#identifier#
|The incident, incident-activity, or other SDO that this activity was a part of.

When this refers to another incident-activity object it indicates that
this activity is a part of the parent activity.

|*sequence_end* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the last point in
an activity is believed to have occurred relative to other activities
that have the same [stixtype]*parent_ref*.

This *MUST NOT* be used if a [stixtype]*parent_ref* is not included.

This *MUST NOT* be less than the [stixtype]*sequence_start* value, but the two can
be equal.

|*sequence_start* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the earliest point
this activity is believed to have occurred relative to other activities
that have the same [stixtype]*parent_ref*.

This *MUST NOT* be used if a [stixtype]*parent_ref* is not included.

This *MUST NOT* exceed the [stixtype]*sequence_end* value, but the two can be equal.

|*start_time* (optional)
|[stixtype]#timestamp#
|The date and time the activity was first recorded. If this is not
present it is assumed to be unknown.

This property *SHOULD* be populated.

|*start_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|The level of fidelity that the start_time is recorded in. This value
*MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be
accurate up to the number of decimals it includes.
|===

<<<

== 3. Vocabularies

=== 3.1 Activity Type Vocabulary

*Type Name*: activity-type-ov

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#administrative#
|Perform an administrative action such as the introduction or change of a policy.

|[stixliteral]#containment#
|The containment phase of incident response

|[stixliteral]#declared#
|When this was officially declared an incident.

|[stixliteral]#detected#
|When the incident was detected.

|[stixliteral]#eradication#
|The eradication phase of incident response.

|[stixliteral]#escalated#
|When the incident was escalated to a major incident.

|[stixliteral]#exercised-control#
|Attempted to use a security control that was already
in place within the environment.

|[stixliteral]#external-outreach#
|Reaching out to an external organization to gain support or information.

|[stixliteral]#external-support#
|Acquire support from an external organization.

|[stixliteral]#implemented-control#
|Implemented a security control within the environment.

|[stixliteral]#natural-disaster#
|A natural disaster took place that may have caused or contributed to an incident.

|[stixliteral]#recovery#
|The recovery phase of incident response.

|[stixliteral]#reported#
|When the incident was reported externally.
|===

<<<

== 4. Enumerations

=== 4.1 Activity Category Enumeration

*Type Name*: activity-category-enum

[width="100%",cols="28%,72%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#attacker#
|This activity was performed by an actor that is believed to be malicious.

|[stixliteral]#defender#
|This activity was performed in an attempt to discover, diagnose, or remediate an incident.

|[stixliteral]#natural#
|This activity was caused or is expected to be caused by a natural phenomena such as a hurricane that may cause both physical or availability impacts on a system.

|[stixliteral]#other#|
This activity was caused by either automated or human activity that is not directly related to intentionally causing or remediating an incident.

|[stixliteral]#unknown#
|This activity cannot currently be categorized.
|===

<<<

=== 4.2 Activity Outcome Enumeration

*Type Name*: activity-outcome-enum

[width="100%",cols="28%,72%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#blocked#
|
The activity was blocked from having its intended effect by pre-emptive
measures.

Attacker activities can be blocked by solutions such as rate limiting or
spam filters.

Defender activities can be blocked due to budget or organizational
restrictions.

|[stixliteral]#ongoing#
|The activity is still occurring.

|[stixliteral]#failed#
|
The activity failed. For attacker activities this would not be due to
any affirmative defense.

For defender activities this indicates that the activity was permitted
and attempted, but did not reach the desired outcome.

For example: running a VisualBasic script failed because it was on a
Linux machine.

|[stixliteral]#occurred#
|The activity took place but not due to any deliberate human action or activity. For example there was a fire in a building because of an accident or lightning strike.

|[stixliteral]#pending#
|The activity has not yet been started or observed, but it is projected or otherwise planned. 

Pending activity may never occur as various factors can cause it to be
blocked or not attempted. As such any time or sequence values for
pending activities should be treated as an estimation or projection that
is subject to change or cancellation.

|[stixliteral]#successful#
|The activity appears to have been successful.

|[stixliteral]#unknown#
|The outcome of the activity is not yet known.
|===

<<<

=== 4.3 Timestamp Fidelity Enumeration

*Type Name*: timestamp-fidelity-enum

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#day#
|
The associated timestamp should be considered to represent a time within
the one day period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for
this activity.

|[stixliteral]#hour#
|The associated timestamp should be considered to represent a time
within the one hour period starting with the provided timestamp.

|[stixliteral]#minute#
|The associated timestamp should be considered to represent a time within the one minute period starting with the provided timestamp.

|[stixliteral]#month#
|
The associated timestamp should be considered to represent a time within
the one month period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the
activity. The day should always be listed as the first or the last day
of the previous month if in a timezone that is offset before UTC.

|[stixliteral]#second#
|The associated timestamp should be considered to represent a time within the one second period starting with the provided timestamp.

|[stixliteral]#year#
|
The associated timestamp should be considered to represent a time within
the one year period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the
activity.

|===

<<<

== 5.0 Relationships

[width="100%",cols="27%,16%,24%,33%",options="header",]
|===
4+^|[stixtr]*Common Relationships*
4+|[stixrelationship]#derived-from#,
[stixrelationship]#duplicate-of#,
[stixrelationship]#related-to#

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*incident-activity*
|[stixrelationship]#detects#
|[stixtype]*incident-activity*
|A defensive activity was used to detect a malicious or threatening activity.

|[stixtype]*incident-activity* 
|[stixrelationship]#blocks#
|[stixtype]*incident-activity*
|An activity is performed to block another.
A defender may block an attacker's activity or vice versa.

|[stixtype]*incident-activity* 
|[stixrelationship]#led-to#
|[stixtype]*incident-activity* 
|One activity led to another.
For example a dropper running allowed a ransomware tool to be downloaded and run.

|[stixtype]*incident-activity* 
|[stixrelationship]#uses#
|[stixtype]*attack-pattern* 
|An activity uses a particular
attack pattern.

|[stixtype]*incident-activity*
|[stixrelationship]#uses#
|[stixtype]*course-of-action*
|An activity uses a
particular course of action.

|[stixtype]*incident-activity*
|[stixrelationship]#creates#
|[stixtype]*indicator*
|An activity was performed that created an indicator.

|[stixtype]*incident-activity*
|[stixrelationship]#impacts#
|[stixtype]*infrastructure*, +
<All STIX Cyber-observable Objects>
|The activity impacts infrastructure
or other resources that are identified by cyber-observable objects.

|[stixtype]*incident-activity*
|[stixrelationship]#located-at#
|[stixtype]*location*
|The incident occurred at a specific location or locations.

|[stixtype]*incident-activity*
|[stixrelationship]#observed#
|<All STIX Cyber-observable Objects>
|STIX cyber-observables were observed as part of this activity, but no information on when they are observed is being shared.

If this can be shared a Sighting should be used to an Observed Data object containing the relevant cyber observables.
|===

<<<

[width="100%",cols="27%,16%,24%,33%",options="header",]
|===
4+^|[stixtr]*Reverse Relationships*

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*indicator*
|[stixrelationship]#based-on#
|[stixtype]*incident-activity*
|An indicator is based on an activity.

|[stixtype]*indicator*
|[stixrelationship]#detected#
|[stixtype]*incident-activity*
|An indicator detected an activity.

|[stixtype]*identity*
|[stixrelationship]#participated-in#
|[stixtype]*incident-activity*
|An identity participated in a specific activity, but as not the primary performer

|[stixtype]*identity*
|[stixrelationship]#performed#
|[stixtype]*incident-activity*
|An identity performed a specific activity.

|[stixtype]*identity*
|[stixrelationship]#contact-for#
|[stixtype]*incident-activity*
|An identity is a point of contact for this activity.

|[stixtype]*malware*
|[stixrelationship]#performed#
|[stixtype]*incident-activity*
|Malware performed a specific activity.

|[stixtype]*tool*
|[stixrelationship]#performed#
|[stixtype]*incident-activity*
|A tool performed a specific activity.
|===

<<<

== Appendix A. Revision History

[width="100%",cols="18%,16%,23%,43%",options="header",]
|===
^|[stixtr]*Revision* ^|[stixtr]*Date* ^|[stixtr]*Editor* ^|[stixtr]*Changes Made*
|01
|<TBD>
|Incident Mini Group
|Initial Version

|===