:stylesheet: stix.css
:stylesdir: ../../asciidoc-shared
:toc: macro
:nofooter:

= [stixtitle]*Incident Core Extension Version 2.0 for STIX^TM^ Version 2.1*

[.stix-doc-information-heading]#Draft#

[.stix-doc-information-heading]#26 March 2023#

[.stix-doc-information-heading]
Editors:
[.stix-indent]
- IMG - Incident Mini Group


[.stix-doc-information-heading]
Additional artifacts:
[.stix-indent]
.This prose specification is one component of a Work Product that also includes:

- STIXâ„¢ Version 2.1 - OS
- Impact Extension Version 1.0 for STIX^TM^ Version 2.1
- Incident Activity Extension Version 1.0 for STIX^TM^ Version 2.1


[.stix-doc-information-heading]
Related work:

[.stix-indent]
.This specification replaces or supersedes: +

- Incident Core Extension Version 1.0 for STIX^TM^ Version 2.1

toc::[]

[.stix-doc-information-heading]*Abstract:*

The current STIX 2.1 Incident object exists as a stub in the hopes that future work would allow STIX Incidents to be more fully fleshed out using extensions, and that in time a set of core features could be defined to be migrated into a future version of the Incident object or the community could arrive at the consensus to continue to use these extensions.

This extension is focused on the core features of an incident across its life cycle by providing mechanisms to record the status of the incident.
It also provides a means to relate these to the impacts and activities stored in separate SDOs.
This extension also provides both new means and examples of connections to a number of existing STIX Objects in order to facilitate highly interoperable verbose reporting that does not overburden analysts to initially generate or maintain.


== 1. Incidents in STIX

Incident objects represent events that have occurred and require further consideration or investigation.
The Incident object should have sufficient properties to represent the current state of the Incident and serve as an anchor point to record both activities related to the and the impact to the enterprise.

The incident core extension exists to allow a whole lifecycle approach for Incident response, reporting and tracking throughout its entire lifecycle while also allowing this information to be easily queried against at scale by systems that exchange STIX 2.1 Incident data.

== 2. Incident Core Extension

The properties and additional types within the Incident Core Extension are defined below. As this is not a top-level object, fields such as identifier are not present.

<<<

[width="100%",cols="37%,23%,40%",options="header",]
|===
^|[stixtr]*Property Name*
^|[stixtr]*Type*
^|[stixtr]*Description*

|*determination* (required)
|[stixtype]#incident-determination-enum#
|A high level determination on the outcome of this incident.
This *SHOULD* be suspected until enough information is available to provide a well researched result.

Some automated tools may flag results as blocked or low-value automatically depending on the tool type or activity.
A tool that blocks a series of phishing emails may create an incident with a blocked determination automatically.

The values of this property *MUST* come from the [stixtype]#incident-determination-enum# enumeration.

|*extension_type* (required)
|[stixtype]#string# 
|The value of this property *MUST* be [stixliteral]#property-extension#

|*investigation_status* (required)
|[stixtype]#open-vocab#
|The current status of the incident investigation.

The values of this property *MUST* come from the [stixtype]#incident-investigation-ov# enumeration.

|*criticality* (optional)
|[stixtype]#integer#
 
|The criticality of the incident.
This value *MUST* be between 0 to 100. This can be translated into qualitative values as described in Appendix A.

|*detection_methods* (optional)
|[stixtype]#list# of type [stixtype]#open-vocab#
|A list of strings containing what was used to detect the activity, e.g., commercial tool names, techniques associated with proprietary solutions, human review, external sources, or other methods.
This should draw from the [stixtype]#detection-methods-ov#.

|*impacted_entity_counts* (optional)
|[stixtype]#entity-count#
|An optional listing of the entity types that were impacted and how many of each were affected.

If this field is not present it should be assumed that this information is not being shared, not that there were no impacted entities.

|*incident_types* (optional)
|[stixtype]#list# of type [stixtype]#open-vocab#
|This property uses an Open Vocabulary that specifies the type of incident that occurred, if applicable.

This is an open vocabulary and values SHOULD come from the [stixtype]#incident-type-ov#.

|*recoverability* (optional)
|[stixtype]#recoverability-enum#
|The recoverability of this particular Incident with respect to feasibility and required time and resources.

The values of this property *MUST* come from the [stixtype]#recoverability-enum#
enumeration.

|*scores* (optional)
|[stixtype]#list# of type [stixtype]#incident-score#
|A list of scores from various automated or manual mechanisms along with optional descriptions.

|===

<<<

=== 2.1 Entity Count Type

*Type Name:* [stixtype]#entity-count#

The Entity Count type represents the count of one or more entity types.
The name of each entity type *MUST* be specified as a key in the dictionary and *MUST* identify the count of the entity that corresponds to the value. Each key *SHOULD* come from [stixtype]#identity-class-ov#.
This value *MUST* be an [stixtype]#integer# that is equal to or greater than zero.

*Examples:*

_100 individuals_
[source,json]
----
{
    "individual": 100
}
----

_1000 systems, 10 organizations, 1 sector_
----
{
    "organization": 10,
    "sector": 1
    "system": 1000
}
----

_0 individuals_

----
{
    "individual": 0
}
----

<<<

=== 2.2 Incident Score Object Type

*Type Name:* [stixtype]#incident-score#

[width="100%",cols="37%,23%,40%",options="header",]
|===
^|[stixtr]*Property Name*
^|[stixtr]*Type* 
^|[stixtr]*Description*

|*name* (required)
|[stixtype]#string# 
|The name of the score. This is normally a system or process name or some combination of these such as [Tool Name] Automated Exposure Score.

|*value* (required)
|[stixtype]#number# 
|The numeric score.

|*description* (optional)
|[stixtype]#string# 
|An optional description about how this score was calculated at for systems that provide these.
|===

<<<

== 3. Vocabularies

=== 3.1 Detection Methods Vocabulary

*Type Name:* [stixtype]#detection-methods-ov#

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* 
^|[stixtr]*Description*

|[stixliteral]#automated-tool#
|An incident is detected by an automated tool.
If this option is used it is generally useful to also include a separate entry for the tool itself.

|[stixliteral]#human-review#
|An incident is detected by human threat hunting.

|[stixliteral]#message-from-attacker#
|Notification comes from a message provided by the attacker including email, a note left of a message or popup message.

|[stixliteral]#system-outage#
|An incident is detected because a system is no longer available.

|[stixliteral]#user-reporting#
|One or more users report an incident.
|===

<<<

=== 3.2 Incident Investigation Open Vocabulary

*Type Name:* [stixtype]#incident-investigation-ov#

[width="100%",cols="24%,76%",options="header",]
|===
^|[stixtr]*Vocabulary Value* 
^|[stixtr]*Description*

|[stixliteral]#closed#
|All defender work on this incident has been concluded.
In some cases, blue teams may make child Incidents of a closed Incident.
In these cases, it is appropriate to mark an initial Incident as closed if the related child incidents that track this work are still open.

|[stixliteral]#new#
|A new incident that has not begun the formal workflow on the defender's network.

|[stixliteral]#open#
|An open incident that is currently being worked.
|===

<<<

=== 3.3 Incident Type Vocabulary

*Type Name:* [stixtype]#incident-type-ov#

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* 
^|[stixtr]*Description*

|[stixliteral]#compromised-system#
|Attackers obtained control of a compromised system.

|[stixliteral]#denial-of-service#
|The incident resulted in a loss of availability for a service or system.

Incidents of this *SHOULD* have an availability impact, but organizations may choose to not share the details of these impacts.

|[stixliteral]#destruction#
|The incident destroyed data or systems.

Incidents of this *SHOULD* have an integrity impact, but organizations may choose to not share the details of these impacts.

|[stixliteral]#equipment-loss#
|A loss of control of physical equipment that is not known to be theft.

|[stixliteral]#equipment-theft#
|Theft of equipment. In general this should be paired with equipment-loss.

|[stixliteral]#major#
|The incident is classified as major based on the internal criteria within the organization or due to external reporting requirements.

|[stixliteral]#supply-chain-customer#
|This incident used a vendor further up in the supply chain where the target was a customer.

|[stixliteral]#supply-chain-vendor#
|This incident targeted a system or product that is supplied to others to enable further attacks.

|[stixliteral]#unauthorized-access#
|Unauthorized access to information.

Incidents of this *SHOULD* have a confidentiality impact, but organizations may choose to not share the details of these impacts.

|[stixliteral]#unauthorized-equipment#
|Usage of unauthorized devices as part of the incident

|[stixliteral]#unauthorized-release#
|The unauthorized release of information.

Incidents of this *SHOULD* have a confidentiality impact, but
organizations may choose to not share the details of these impacts.

|[stixliteral]#unauthorized-use#
|The usage of information that falls outside of official purposes
|===

<<<

== 4. Enumerations

=== 4.1 Incident Determination Enumeration

*Type Name*: [stixtype]#incident-determination-enum#

[width="100%",cols="28%,72%",options="header",]
|===
^|[stixtr]*Vocabulary Value* 
^|[stixtr]*Description*

|[stixliteral]#blocked#
|The incident had no impact due to pre-emptive measures including rate limiting or spam filters.

|[stixliteral]#successful-attempt#
|An incident has been determined to have caused at least some harm.

|[stixliteral]#failed-attempt#
|The incident had no impact but not due to any affirmative defense for example a password guesser failed but was also not rate limited.

|[stixliteral]#false-positive#
|An incident was determined to have been triggered by a false alert and no action including automatically performed automated actions were needed to remediate the issue.

This should not be used when an incident was flagged correctly, but is of no importance. For findings of that nature low-value should be used.

|[stixliteral]#low-value#
|An incident that has been deemed to be sufficiently unimportant for human intervention or may otherwise be considered noise.

|[stixliteral]#suspected#
|An incident is suspected, but not yet confirmed.
|===


<<<

=== 4.2 Recoverability Enumeration

*Type Name*: [stixtype]#recoverability-enum#

[width="100%",cols="24%,76%",options="header",]
|===
^|[stixtr]*Vocabulary Value* 
^|[stixtr]*Description*

|[stixliteral]#extended#
|Time to recovery is unpredictable; additional resources and outside help are necessary.

|[stixliteral]#not-applicable#
|No recovery is necessary.

|[stixliteral]#not-recoverable#
|Recovery from the incident is not possible.

|[stixliteral]#regular#
|Time to recovery is predictable with existing resources.

|[stixliteral]#supplemented#
|Time to recovery is predictable with additional
resources.
|===

<<<

== 5.0 Relationships

[width="100%",cols="24%,23%,20%,33%",options="header",]
|===
4+^|[stixtr]*Common Relationships*
4+|[stixrelationship]#derived-from#,
[stixrelationship]#duplicate-of#,
[stixrelationship]#related-to#

|*Source*
|*Type* 
|*Target* 
|*Description*

|[stixtype]#incident#
|[stixrelationship]#led-to#
|[stixtype]#incident#
|One incident led to another.

|[stixtype]#incident#
|[stixrelationship]#impacts#
|[stixtype]#identity#, +
[stixtype]#infrastructure#
|An incident has an impact on the victim or specific infrastructure.

|[stixtype]#incident#
|[stixrelationship]#attributed-to#
|[stixtype]#intrusion-set#, +
[stixtype]#threat-actor#
|The incident has been attributed to the intrusion set or threat actor.

|[stixtype]#incident#
|[stixrelationship]#targets#
|[stixtype]#identity#, +
[stixtype]#infrastructure#
|An incident was targeted at the victim or specific infrastructure.

|[stixtype]#incident#
|[stixrelationship]#located-at#
|[stixtype]#location#
|The incident occurred at a specific location or locations.

4+^|*Reverse Relationships*
|[stixtype]#campaign#
|[stixrelationship]#associated-with#
|[stixtype]#incident#
|The incident in question is part of the campaign that is associated with.

|[stixtype]#identity#
|[stixrelationship]#contact-for#
|[stixtype]#incident#
|An identity should be considered a point of contact for an incident.

This can be used to supplement the created_by_ref in cases where external authorship would prevent using it for this purpose.

|[stixtype]#indicator#
|[stixrelationship]#detected#
|[stixtype]#incident#
|An indicator was responsible for detecting the incident.
|===

<<<

== Appendix A. Incident Criticality Mapping

This appendix defines mappings for criticality scales to be used by the criticality property.
A value of "Not Specified" in the table below means that the criticality property is not present.

[width="100%",cols="38%,35%,27%",options="header",]
|===
|[stixtr]*5 Qualitative*
|[stixtr]*STIX Criticality Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|False Positive
|0 
|0
|Low
|15 
|1-29
|Moderate
|40 
|30-49
|High#
|70 
|50-89
|Extreme
|95 
|90-100
|===

[width="100%",cols="38%,34%,28%",options="header",]
|===
|[stixtr]*Major / Minor*
|[stixtr]*STIX Criticality Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|None
|0 
|0
|Minor
|25 
|1-49
|Major
|75 
|50-100
|===

[width="100%",cols="38%,34%,28%",options="header",]
|===
|[stixtr]*Major / Minor / Critical*
|[stixtr]*STIX Criticality Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|None
|0 
|0
|Minor
|25 
|1-49
|Major
|70 
|50-89
|Critical
|95 
|90-100
|===

[width="100%",cols="38%,34%,28%",options="header",]
|===
|[stixtr]*None, Low, High, Extreme*
|[stixtr]*STIX Criticality Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|None
|0 
|0
|Low
|20 
|1-39
|High
|65 
|40-89
|Extreme
|95 
|90-100
|===

[width="100%",cols="38%,34%,28%",options="header",]
|===
|[stixtr]*VERIS*
|[stixtr]*STIX Criticality Value* 
|[stixtr]*Range of Values*
|Unknown
|Not Specified 
|N/A
|Insignificant
|10 
|0-19
|Distracting
|35 
|20-49
|Painful
|60 
|50-69
|Damaging#
|80 
|70-90
|Catastrophic
|95 
|90-100
|===

<<<

[width="100%",cols="37%,35%,28%",options="header",]
|===
|[stixtr]*0 to 10*
|[stixtr]*STIX Criticality Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|0
|0 
|0-4
|1
|10 
|5-14
|2
|20 
|15-24
|3
|30 
|25-34
|4
|40 
|35-44
|5
|50 
|45-54
|6
|60 
|55-64
|7
|70 
|65-74
|8
|80 
|75-84
|9
|90 
|85-94
|10
|100 
|95-100
|===

<<<

== Appendix B. Acknowledgements

*Primary Editor*

Jeffrey Mates, US Department of Defense (DoD)

*Contributors*

The following individuals were members of the OASIS CTI Technical Committee and contributed time and effort to ensure that this extension would be possible.
Their contributions are gratefully acknowledged:

* Alexandre Cabrol Perales, Sopra Steria Group
* Ben Ottoman, Cyber Threat Intelligence Network, Inc. (CTIN)
* Christian Hunt, Copado
* Christopher Robinson, Cyber Threat Intelligence Network, Inc. (CTIN)
* David Kemp, National Security Agency (NSA)
* Duncan Sparrell, sFractal Consulting LLC
* Emily Ratliff, IBM
* Jane Ginn, Cyber Threat Intelligence Network, Inc. (CTIN)
* Jason Keirstead, IBM
* Jeremy Berthelet, Sopra Steria Group
* Keven Ates, US Federal Bureau of Investigation
* Margaux Quittelier, Sopra Steria Group
* Michael Rosa, National Security Agency (NSA)
* Richard Piazza, MITRE Corporation
* Rob Coderre, Accenture
* Robert Keith, Accenture
* Ryan Hohimer, DarkLight, Inc.
* Scott Robertson, Kaiser Permanente
* Trey Darley, CCB/CERT.be
* Vasileios Mavroeidis, University of Oslo

<<<

== Appendix C. Revision History

[width="100%",cols="18%,16%,23%,43%",options="header",]
|===
^|[stixtr]*Revision* ^|[stixtr]*Date* ^|[stixtr]*Editor* ^|[stixtr]*Changes Made*
|01
|2022-05-23
|Incident Mini Group
|Initial Version

|02
|2022-10-27
|Jeffrey Mates 
|Added [stixliteral]#ongoing# to [stixtype]#activity-outcome-enum#.  Removed normative text for *attacker_activity*.*pattern_ref* that indicated a field that does not exist can be excluded if it is present.

|03
|2023-02-15
|Jeffrey Mates 
|Added labels and criticality to all impact types.  Made impacted_refs optional for availability impact.

Replaced *availability_impact* with *availability_impacts* new guidance is to use scores for this in more granular *availability_impacts*.

Added [stixliteral]#ransom-demand# and [stixliteral]#ransom-payment# to [stixtype]#monetary-impact-type-ov#.


|04
|
|
|<TBD>

|===