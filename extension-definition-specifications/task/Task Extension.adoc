:stylesheet: stix.css
:stylesdir: ../../asciidoc-shared
:toc: macro
:nofooter:

= [stixtitle]*Task Extension Version 1.0 for STIX^TM^ Version 2.1*

[.stix-doc-information-heading]#Draft#

[.stix-doc-information-heading]#26 March 2023#

[.stix-doc-information-heading]
Editors:
[.stix-indent]
* IMG - Incident Mini Group


[.stix-doc-information-heading]
Additional artifacts:
[.stix-indent]
.This prose specification is one component of a Work Product that also includes:

- STIXâ„¢ Version 2.1 - OS
- Impact Extension Version 1.0 for STIX^TM^ Version 2.1
- Incident Core Extension Version 2.0 for STIX^TM^ Version 2.1


[.stix-doc-information-heading]
Related work:

[.stix-indent]
.This specification replaces or supersedes: +

- N/A

toc::[]

[.stix-doc-information-heading]*Abstract:*

The current STIX 2.1 Incident object exists as a stub in the hopes that future work would allow STIX Incidents to be more fully fleshed out using extensions, and that in time a set of core features could be defined to be migrated into a future version of the Incident object or the community could arrive at the consensus to continue to use these extensions.

This extension is focused related to tasks performed as part of routine system maintenance, responding to events, and responding to incidents.
Tasks can be used independently of events or incidents, but when sharing cyber threat intelligence are most often used when discussing the tasks associated with the incident response lifecycle.

== 1. Tasks in STIX

Tasks represent activities that have occurred, are ongoing, or are planned within an organization.
Tasks can store a list of subtasks that can be optionally ordered to provide greater fidelity.
Tasks are often performed prior to incident being declared in response to Events or as part of routine maintenance and support of networks or other systems.

Tasks have a large number of common relationships that allows for sharing detailed information about the who, what and where the task.
The what and when of an task is recorded directly on the task itself.

In some environments it is possible to have automated playbooks create and execute tasks.
If a STIX object exists to represent these playbooks the playbook or specific action within the playbook can be referenced by the Task as a template.
If no STIX object exists this can be captured as an external reference.

<<<

== 2. Task Extension

[width="100%",cols="100%",stripes=odd]
|===
^|[stixtr]*Required Common Properties*
|*created*,
*id*,
*modified*,
*spec_version*,
*type*

^|[stixtr]*Optional Common Properties*

|*created_by_ref*,
*revoked*,
*labels*,
*confidence*,
*lang*,
*external_references*,
*object_marking_refs*,
*granular_markings*,
*extensions*

^|[stixtr]*Not Applicable Common Properties*

|*defanged*

^|[stixtr]*Task Object Specific Properties*

|*task_type*,
*changed_objects*,
*description*,
*end_time*,
*end_time_fidelity*,
*error*,
*impact_entity_counts*,
*name*,
*outcome*,
*priority*,
*start_time*,
*start_time_fidelity*,
*subtasks*,
*template_refs*
|===

|===
^|[stixtr]*Property Name* ^|[stixtr]*Type* ^|[stixtr]*Description*

|*outcome* (required)
|[stixtype]#task-outcome-enum#
|The outcome of the task.

|*type* (required)
|[stixtype]#string#
|The value of this property *MUST* be set to [stixliteral]#task#.

|*changed_objects* (optional)
|[stixtype]#list# of type [stixtype]#state-change#
|A list of changes that this task has caused.
This is typically used to indicate how an task has affected impacts.

|*task_type* (optional)
|[stixtype]#open-vocabulary#
|A high level type for the task in order to enable aggregation and summaries.
This should be drawn from task-type-ov.

|*description* (optional)
|[stixtype]#string#
|A description of task that occurred.

|*end_time* (optional)
|[stixtype]#timestamp#
|The date and time the task was last recorded. If this is not present it is assumed to be unknown.

|*end_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|The level of fidelity that the end_time is recorded in.
This value *MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be
accurate up to the number of decimals it includes.

|*error* (optional)
|[stixtype]#string#
|Details about any failures or deviations that occurred in the task.

|*impacted_entity_counts* (optional)
|[stixtype]#entity-count#
|An optional listing of the entity types that were impacted and how many of each were affected.

This is primarily used when recording victim notifications.

|*name* (optional)
|[stixtype]#string#
|An optional name used to identify the task.

|*priority* (optional)
|[stixtype]#integer#
|The priority or importance of the task.
This value *MUST* be between 0 to 100. This can be translated into qualitative values as described in Appendix A.

|*start_time* (optional)
|[stixtype]#timestamp#
|The date and time the task was first recorded. If this is not
present it is assumed to be unknown.

This property *SHOULD* be populated.

|*start_time_fidelity* (optional)
|[stixtype]#timestamp-fidelity-enum#
|The level of fidelity that the start_time is recorded in. This value
*MUST* come from [stixtype]#timestamp-fidelity-enum#.

If no value is provided the timestamp should be considered to be
accurate up to the number of decimals it includes.

|*subtasks* (optional)
|[stixtype]#list# of type [stixtype]#task-sequence#
|A list of sub-tasks that this task was composed of.

|===

<<<

=== 2.1 Task-Sequence Object Type

*Type Name:* [stixtype]#task-sequence#

[width="100%",cols="37%,23%,40%",options="header",]
|===
^|[stixtr]*Property Name*
^|[stixtr]*Type* 
^|[stixtr]*Description*

|*task_ref* (required)
|[stixtype]#identifier# 
|This property specifies the task that ocurred at this point in the sequence.

The object referenced *MUST* be of type [stixtype]#task#.

|*sequence_end* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the last point in an task is believed to have occurred relative to other [stixtype]#task-sequence# entries in the same list.

This *MUST NOT* be less than the [stixtype]*sequence_start* value, but the two can be equal.

|*sequence_start* (optional)
|[stixtype]#integer#
|An optional sequence number starting at 0 that shows the earliest point this task is believed to have occurred relative to other [stixtype]#task-sequence# entries in the same list.

This *MUST NOT* exceed the [stixtype]*sequence_end* value, but the two can be equal.
|===

<<<

== 3. Vocabularies

=== 3.1 Task Type Vocabulary

*Type Name*: task-type-ov

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#administrative#
|Perform an administrative action such as the introduction or change of a policy.

|[stixliteral]#containment#
|The containment phase of incident response

|[stixliteral]#declared#
|When this was officially declared an incident.

|[stixliteral]#detected#
|When the incident was detected.

|[stixliteral]#eradication#
|The eradication phase of incident response.

|[stixliteral]#escalated#
|When the incident was escalated to a major incident.

|[stixliteral]#exercised-control#
|Attempted to use a security control that was already
in place within the environment.

|[stixliteral]#external-intelligence#
|Used external intelligence information.

|[stixliteral]#external-outreach#
|Reaching out to an external organization to gain support or information.

|[stixliteral]#external-support#
|Acquire support from an external organization.

|[stixliteral]#implemented-control#
|Implemented a security control within the environment.

|[stixliteral]#recovery#
|The recovery phase of incident response.

|[stixliteral]#reported#
|When the incident was reported externally.

|[stixliteral]#routine-updates#
|Performed a routine update in the environment including patching.

|[stixliteral]#victim-notification#
|Notified victims, potentially impacted individuals or organizations about the incident.
|===

<<<

== 4. Enumerations

=== 4.1 Task Outcome Enumeration

*Type Name*: task-outcome-enum

[width="100%",cols="28%,72%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*

|[stixliteral]#cancelled#
|The task was planned or started, but later cancelled.

|[stixliteral]#failed#
|The task has been completed, but failed.

|[stixliteral]#ongoing#
|The task is still taking place.

|[stixliteral]#pending#
|The task has not yet been started, but is currently planned. 

|[stixliteral]#successful#
|The task was completed successfully.

|[stixliteral]#unknown#
|The status of this task is currently unknown.
|===

<<<

=== 4.2 Timestamp Fidelity Enumeration

*Type Name*: timestamp-fidelity-enum

[width="100%",cols="31%,69%",options="header",]
|===
^|[stixtr]*Vocabulary Value* ^|[stixtr]*Description*
|[stixliteral]#day#
|
The associated timestamp should be considered to represent a time within
the one day period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for
this activity.

|[stixliteral]#hour#
|The associated timestamp should be considered to represent a time
within the one hour period starting with the provided timestamp.

|[stixliteral]#minute#
|The associated timestamp should be considered to represent a time within the one minute period starting with the provided timestamp.

|[stixliteral]#month#
|
The associated timestamp should be considered to represent a time within
the one month period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the
activity. The day should always be listed as the first or the last day
of the previous month if in a timezone that is offset before UTC.

|[stixliteral]#second#
|The associated timestamp should be considered to represent a time within the one second period starting with the provided timestamp.

|[stixliteral]#year#
|
The associated timestamp should be considered to represent a time within
the one year period starting with the provided timestamp.

Hours and minutes should be understood to establish the timezone for the
activity.

|===

<<<

== 5.0 Relationships

[width="100%",cols="27%,16%,24%,33%",options="header",]
|===
4+^|[stixtr]*Common Relationships*
4+|[stixrelationship]#derived-from#,
[stixrelationship]#duplicate-of#,
[stixrelationship]#related-to#

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*task*
|[stixrelationship]#uses#
|[stixtype]*course-of-action*
|An task uses a particular course of action.

|[stixtype]*task* 
|[stixrelationship]#blocks#
|[stixtype]*event*
|A task was performed to block a potential event.

|[stixtype]*task* 
|[stixrelationship]#causes#
|[stixtype]*event*
|A task was performed that caused an event, usually due to an error.

|[stixtype]*task*
|[stixrelationship]#detects#
|[stixtype]*event*
|A task was used to detect an event.

|[stixtype]*task*
|[stixrelationship]#creates#
|[stixtype]*indicator*
|A task was performed that created an indicator.

|[stixtype]*task*
|[stixrelationship]#ed#
|[stixtype]*infrastructure*, +
<All STIX Cyber-observable Objects>
|The task impacts infrastructure or other resources that are identified by cyber-observable objects.

|[stixtype]*task*
|[stixrelationship]#located-at#
|[stixtype]*location*
|The task occurred at a specific location or locations.

|===

<<<

[width="100%",cols="27%,16%,24%,33%",options="header",]
|===
4+^|[stixtr]*Reverse Relationships*

|*Source* |*Type* |*Target* |*Description*

|[stixtype]*identity*
|[stixrelationship]#assigned#
|[stixtype]*task*
|An identity has been assigned the task

|[stixtype]*identity*
|[stixrelationship]#contact-for#
|[stixtype]*task*
|An identity is a point of contact for this task.

|[stixtype]*identity*
|[stixrelationship]#participated-in#
|[stixtype]*task*
|An identity participated in a specific task, but as not the primary performer

|[stixtype]*identity*
|[stixrelationship]#performed#
|[stixtype]*task*
|An identity performed a specific task.

|[stixtype]*tool*
|[stixrelationship]#performed#
|[stixtype]*task*
|A tool performed a specific task.
|===

<<<

== Appendix A. Task Priority Mapping

This appendix defines mappings for priority scales to be used by the priority property for tasks.
A value of "Not Specified" in the table below means that the priority property is not present.

[width="100%",cols="38%,35%,27%",options="header",]
|===
|[stixtr]*P Scale*
|[stixtr]*STIX Priority Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|P3
|20
|0-39
|P2
|60
|40-74
|P1
|90
|75-100
|===

[width="100%",cols="38%,35%,27%",options="header",]
|===
|[stixtr]*5 Qualitative*
|[stixtr]*STIX Priority Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|Minor
|5
|0-10
|Low
|20 
|10-29
|Moderate
|40 
|30-49
|High
|70 
|50-89
|Critical
|95 
|90-100
|===

[width="100%",cols="38%,35%,27%",options="header",]
|===
|[stixtr]*6 Qualitative*
|[stixtr]*STIX Priority Value* 
|[stixtr]*Range of Values*
|Not Specified
|Not Specified 
|N/A
|Lowest
|5
|0-10
|Low
|20 
|10-29
|Medium
|40 
|30-49
|High
|65 
|50-74
|Highest
|85
|75-90
|Blocker
|95
|90-100
|===

<<<

== Appendix A. Revision History

[width="100%",cols="18%,16%,23%,43%",options="header",]
|===
^|[stixtr]*Revision* ^|[stixtr]*Date* ^|[stixtr]*Editor* ^|[stixtr]*Changes Made*
|01
|<TBD>
|Incident Mini Group
|Initial Version

|===